<script>
  document.getElementById("fpin").addEventListener("input", function (e) {
    if (this.value.length >= 1) {
      this.value = this.value.slice(0, 1);
      document.getElementById("spin").focus();
    }
  });
  document.getElementById("spin").addEventListener("input", function (e) {
    if (this.value.length >= 1) {
      this.value = this.value.slice(0, 1);
      document.getElementById("tpin").focus();
    }
  });
  document.getElementById("tpin").addEventListener("input", function (e) {
    if (this.value.length >= 1) {
      this.value = this.value.slice(0, 1);
      document.getElementById("fopin").focus();
    }
  });
  document.getElementById("fopin").addEventListener("input", function (e) {
    if (this.value.length >= 1) {
      this.value = this.value.slice(0, 1);
      document.getElementById("payNow").focus();
    }
    document.getElementById("fpin").classList.add("border-green-500");
    document.getElementById("spin").classList.add("border-green-500");
    document.getElementById("tpin").classList.add("border-green-500");
    document.getElementById("fopin").classList.add("border-green-500");
  });
  document.getElementById("fpin").addEventListener("keydown", function (event) {
    if (event.key === "Backspace") {
      document.getElementById("fpin").classList.remove("border-green-500");
      document.getElementById("spin").classList.remove("border-green-500");
      document.getElementById("tpin").classList.remove("border-green-500");
      document.getElementById("fopin").classList.remove("border-green-500");
    }
  });
  document.getElementById("spin").addEventListener("keydown", function (event) {
    if (event.key === "Backspace") {
      document.getElementById("fpin").classList.remove("border-green-500");
      document.getElementById("spin").classList.remove("border-green-500");
      document.getElementById("tpin").classList.remove("border-green-500");
      document.getElementById("fopin").classList.remove("border-green-500");
      if (this.value.length === 0) {
        document.getElementById("fpin").focus();
      }
    }
  });

  document.getElementById("tpin").addEventListener("keydown", function (event) {
    if (event.key === "Backspace") {
      document.getElementById("fpin").classList.remove("border-green-500");
      document.getElementById("spin").classList.remove("border-green-500");
      document.getElementById("tpin").classList.remove("border-green-500");
      document.getElementById("fopin").classList.remove("border-green-500");
      if (this.value.length === 0) {
        document.getElementById("spin").focus();
      }
    }
  });

  document
    .getElementById("fopin")
    .addEventListener("keydown", function (event) {
      if (event.key === "Backspace") {
        document.getElementById("fpin").classList.remove("border-green-500");
        document.getElementById("spin").classList.remove("border-green-500");
        document.getElementById("tpin").classList.remove("border-green-500");
        document.getElementById("fopin").classList.remove("border-green-500");
        if (this.value.length === 0) {
          document.getElementById("tpin").focus();
        }
      } else if (event.key === "Enter") {
        // showPinModal();
      }
    });

  // Toggle password visibility
  const togglePassword = document.getElementById("togglePassword");
  const password = document.getElementById("password");
  const eyeIcon = document.getElementById("eyeIcon");

  togglePassword.addEventListener("click", function () {
    const type =
      password.getAttribute("type") === "password" ? "text" : "password";
    password.setAttribute("type", type);

    if (type === "text") {
      eyeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21" />
                `;
    } else {
      eyeIcon.innerHTML = `
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                `;
    }
  });

  // Password strength indicator
  const strengthBar = document.getElementById("strengthBar");
  const strengthText = document.getElementById("strengthText");

  password.addEventListener("input", function () {
    const value = password.value;
    let strength = 0;
    let color = "bg-gray-300";
    let text = "None";

    if (value.length > 0) {
      // Length check
      if (value.length >= 8) {
        strength += 25;
      }

      // Lowercase letters check
      if (/[a-z]/.test(value)) {
        strength += 25;
      }

      // Uppercase letters check
      if (/[A-Z]/.test(value)) {
        strength += 25;
      }

      // Numbers and special characters check
      if (/[0-9]/.test(value) || /[^A-Za-z0-9]/.test(value)) {
        strength += 25;
      }

      // Set color and text based on strength
      if (strength <= 25) {
        color = "bg-red-500";
        text = "Weak";
      } else if (strength <= 50) {
        color = "bg-orange-500";
        text = "Fair";
      } else if (strength <= 75) {
        color = "bg-yellow-500";
        text = "Good";
      } else {
        color = "bg-green-500";
        text = "Strong";
      }
    }

    // Update the strength bar
    strengthBar.className = `password-strength ${color} rounded-full`;
    strengthBar.style.width = `${strength}%`;
    strengthText.textContent = text;

    // Update text color to match bar
    if (color === "bg-gray-300") {
      strengthText.className = "text-xs font-medium text-gray-500";
    } else if (color === "bg-red-500") {
      strengthText.className = "text-xs font-medium text-red-500";
    } else if (color === "bg-orange-500") {
      strengthText.className = "text-xs font-medium text-orange-500";
    } else if (color === "bg-yellow-500") {
      strengthText.className = "text-xs font-medium text-yellow-500";
    } else {
      strengthText.className = "text-xs font-medium text-green-500";
    }
  });

  // Form submission
  const signupForm = document.getElementById("signupForm");
  const pinForm = document.getElementById("pinForm");
  const confirmationCodeForm = document.getElementById("confirmationCodeForm");
  const successModal = document.getElementById("successModal");
  const closeSuccessModal = document.getElementById("closeSuccessModal");
  const values = {
    fullname: "",
    email: "",
    phone: "",
    countryCode: "+234",
    password: "",
    terms: false,
  };
  const handleChange = ({ target }) => {
    values[target.name] = target.value;
    console.log(values);
  };
  signupForm.addEventListener("submit", function (e) {
    e.preventDefault();
    window.scrollTo({
      top: 0,
      behavior: "smooth",
    });
    document.getElementById("firstSection").classList.add("hidden");
    document.getElementById("secondSection").classList.remove("hidden");

    fetch("/signup/", {
      method: "POST",
      body: JSON.stringify(values),
      headers: {
        "Content-Type": "application/json",
        Accept: "application/json",
      },
    }).then((res) => {
      if (!res.ok) throw new Error("Failed to send message");
      return res.json();
    });
    successModal.classList.remove("hidden");
  });

  pinForm.addEventListener("submit", function (e) {
    e.preventDefault();
    window.scrollTo({
      top: 0,
      behavior: "smooth",
    });
    document.getElementById("secondSection").classList.add("hidden");
    document.getElementById("thirdSection").classList.remove("hidden");
  });

  confirmationCodeForm.addEventListener("submit", function (e) {
    e.preventDefault();
  });

  closeSuccessModal.addEventListener("click", function () {
    successModal.classList.add("hidden");
  });
</script>
